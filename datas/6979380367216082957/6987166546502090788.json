{"article_id": "6987166546502090788", "article_info": {"article_id": "6987166546502090788", "user_id": "131597122679661", "category_id": "6809637767543259144", "tag_ids": [6809640407484334093, 6809640398105870343], "visible_level": 0, "link_url": "", "cover_image": "https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0003d74d328f45038df7bf0f4f82660c~tplv-k3u1fbpfcp-watermark.image", "is_gfw": 0, "title": "\u3010\u5e72\u8d27\u3011\u79c1\u85cf\u7684\u8fd9\u4e9b\u9ad8\u7ea7\u5de5\u5177\u51fd\u6570\uff0c\u4f60\u62e5\u6709\u51e0\u4e2a?", "brief_content": "\u7528\u6781\u5176\u7cbe\u7b80\u7684\u4ee3\u7801\uff0c\u7f16\u5199\u7684\u9ad8\u7ea7\u5de5\u5177\u51fd\u6570\uff0c\u8986\u76d6localStorage\u5df2\u4f7f\u7528\u7a7a\u95f4\uff0c\u684c\u9762\u901a\u77e5\uff0c\u89c6\u9891\u622a\u56fe\uff0cbase64\u7f16\u7801\u548c\u89e3\u7801\uff0cUUID\u751f\u6210\uff0c\u5e8f\u5217\u751f\u6210\u5668\u7b49\u7b49\uff0c\u603b\u6709\u4e00\u4e2a\u7559\u7684\u4f4f\u4f60\u3002", "is_english": 0, "is_original": 1, "user_index": 12.284935880354817, "original_type": 0, "original_author": "", "content": "", "ctime": "1626826589", "mtime": "1626846695", "rtime": "1626846695", "draft_id": "6982355260585508894", "view_count": 22324, "collect_count": 728, "digg_count": 540, "comment_count": 76, "hot_index": 1732, "is_hot": 0, "rank_index": 1.1182038, "status": 2, "verify_status": 1, "audit_status": 2, "mark_content": "---\ntheme: juejin\n---\n\n\u672c\u6587\u5df2\u53c2\u4e0e\u597d\u6587\u53ec\u96c6\u4ee4\u6d3b\u52a8\uff0c\u70b9\u51fb\u67e5\u770b\uff1a[\u540e\u7aef\u3001\u5927\u524d\u7aef\u53cc\u8d5b\u9053\u6295\u7a3f\uff0c2\u4e07\u5143\u5956\u6c60\u7b49\u4f60\u6311\u6218\uff01](https://juejin.cn/post/6978685539985653767)\n\n## \u524d\u8a00\n\u5f88\u591a\u529f\u80fd\uff0c\u5176\u5b9e\u5185\u7f6e\u7684Web API\u5df2\u652f\u6301\uff0c  \n* \u6bd4\u5982\u57fa\u4e8e`URLSearchParams`\u6216\u8005`URL`\u7684queryString\u83b7\u53d6\u548c\u751f\u6210   \n* \u6bd4\u5982\u57fa\u4e8e`btoa,atob`\u7684base64\u7684\u7f16\u7801\u548c\u89e3\u7801   \n* \u6bd4\u5982\u57fa\u4e8e`sendBeacon`\u7684\u6570\u636e\u4e0a\u62a5   \n* \u6bd4\u5982\u57fa\u4e8e `Array.from`\u7684\u5e8f\u5217\u751f\u6210\n* \u6bd4\u5982\u57fa\u4e8e`canvas`\u7684\u89c6\u9891\u622a\u56fe\n* \u6bd4\u5982\u57fa\u4e8e`URL`\u7684UUID\u751f\u6210\n\n\u6211\u4eec\u7528\u7cbe\u7b80\u7684\u4ee3\u7801\u6765\u5b9e\u73b0\u76f8\u5bf9\u590d\u6742\u7684\u529f\u80fd\uff0c\u6ca1\u6709\u7b2c\u4e09\u65b9\u5e93\uff0c\u4f60\u4e5f\u80fd\u79c0\u5f97\u98de\u8d77\u3002\n\n\u672c\u6587\u6536\u5f55\u5728 **[\u57fa\u7840\u8fdb\u9636](https://juejin.cn/column/6979380367216082957)** \u4e13\u680f\uff0c\u6b22\u8fce\u5173\u6ce8\u548c\u6536\u85cf, \u5f80\u671f\u7ecf\u5178\uff1a\n* [\u4e09\u5343\u6587\u5b57\uff0c\u4e5f\u6ca1\u5199\u597d Function.prototype.call](https://juejin.cn/post/6978744007601946654) 200+ star\n* [\u90a3\u4e9b\u4f60\u719f\u6089\u800c\u53c8\u964c\u751f\u7684\u51fd\u6570](https://juejin.cn/post/6977239278145241101) 200 star    \n* [\u8fd916\u79cd\u539f\u751f\u51fd\u6570\u548c\u5c5e\u6027\u7684\u533a\u522b\uff0c\u4f60\u771f\u7684\u77e5\u9053\u5417\uff1f \u7cbe\u5fc3\u6536\u96c6\uff0c\u9ad8\u7ea7\u524d\u7aef\u5fc5\u5907\u77e5\u8bc6\uff0c\u5feb\u5feb\u6253\u5305\u5e26\u8d70](https://juejin.cn/post/6982742095375597575) 96 star\n  \n \u76ee\u5f55(\u65b9\u4fbf\u79fb\u52a8\u7aef\u9605\u8bfb)\n* localStorage\u7684\u5df2\u4f7f\u7528\u7a7a\u95f4\n* \u5e26\u56fe\u5e26\u4e8b\u4ef6\u7684**\u684c\u9762\u901a\u77e5**\n* \u539f\u751f30\u884c\u4ee3\u7801\u5b9e\u73b0\u89c6\u9891\u622a\u56fe\n* \u57fa\u4e8e`URLSearchParams`\u83b7\u53d6queryString\u7684\u503c\n* \u57fa\u4e8e`atob`\u548c`btoa`\u7684base64\u7f16\u7801\u548c\u89e3\u7801\n* **\u975e\u6b63\u5219\u66ff\u6362**html\u4ee3\u7801encode\u548cdecode\n* \u76f8\u5bf9\u5730\u5740\u8f6c\u6362\u4e3a\u7edd\u5bf9\u5730\u5740\n* \u57fa\u4e8e`URL`\u6216\u8005`Crypto.getRandomValues`\u751f\u6210UUID\n* \u57fa\u4e8e`Array.from`\u7684\u5e8f\u5217\u751f\u6210\u5668\n* \u57fa\u4e8e`sendBeacon`\u7684\u5b89\u5168\u7684\u6570\u636e\u4e0a\u62a5\n* \u57fa\u4e8e`toLocaleString`\u5343\u5206\u4f4d\n* Promise\u987a\u5e8f\u6267\u884c\n* \u5ef6\u65f6\u6267\u884cdelay\n* \u8fdb\u5ea6\u503c\u6620\u5c04\n* \u6ed1\u6eda\u52a8\u9875\u9762\u5230\u9876\u90e8\n* \u7981\u6b62\u9009\u62e9\u548c\u590d\u5236\n* \u7981\u6b62\u56fe\u7247\u62d6\u62fd\n* \u81ea\u589e\u957fID\n\n\n## localStorage\u7684\u5df2\u4f7f\u7528\u7a7a\u95f4\n\n\u5728\u8f83\u65b0\u7684chrome\u4e0a\u6d4b\u8bd5\uff0clocalStorage\u7684\u5b58\u50a8\u662f**\u6309\u7167\u5b57\u7b26\u4e2a\u6570\u6765\u7b97\u7684\u3002 \u5305\u542b\u952e\u548c\u503c\u7684**\u3002   \n\u6240\u4ee5\u5728\u6d4b\u8bd5\u4ee3\u7801\u4e2d\uff0c\u4f60\u628a`a`\u4fee\u6539`\u554a`\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5b58\u50a8\u7684\u6570\u91cf\u3002 **\u4f46\u662f\u952e\u7684\u957f\u5ea6\uff0c\u4f1a\u5f71\u54cd\u5b58\u50a8\u7684\u6570\u91cf\u3002**\n\n**\u4ee3\u7801**\n```js\nfunction getLSUsedSpace() {\n    return Object.keys(localStorage).reduce((total, curKey) => {\n        if (!localStorage.hasOwnProperty(curKey)) {\n            return total;\n        }\n        total += localStorage[curKey].length + curKey.length;\n        return total;\n    }, 0)\n}\n\n```\n\n**\u793a\u4f8b**\n```js\nlocalStorage.clear();\nlocalStorage.a = \"\u554a\";\nconsole.log(getLSUsedSpace()); // 2\n```\n\n**\u6ea2\u51fa\u6d4b\u8bd5**\uff1a\n\n`key`\u7684\u503c\u4e3a\u957f\u5ea6\u4e3a10\u7684 `kkkkkkkkkk`:   \n\u8f93\u51fa\u7ed3\u679c\uff1a Max: 5242880  value Length: 5242870   \n\u5f53\u4f60\u628a`key`\u4fee\u6539\u957f\u5ea6\u4e3a1\u7684`k`:   \n\u8f93\u51fa\u7ed3\u679c\uff1aMax: 5242880  value Length: 5242879\n```js\n\nlocalStorage.clear();\nlet valLength = 0\ntry {\n    let str = Array.from({ length: 5242800 }, () => \"\u554a\").join(\"\");\n    valLength = str.length;\n    for (let i = 0; i < 10000000000000; i++) {\n        str += \"a\"\n        valLength += 1;\n        localStorage.setItem(`kkkkkkkkkk`, str);\n    }\n\n} catch (err) {\n    console.error(\"\u5b58\u50a8\u5931\u8d25\", err);\n    console.log(\"Max:\", getLSUsedSpace(), \" value Length:\", valLength)\n}\n```\n![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0e32531e2b4340fda3293f44536f8e99~tplv-k3u1fbpfcp-watermark.image)\n\n\n\n**\u6ce8\u610f**\n\n1. \u8d85\u8fc7\u5b58\u50a8\u4e0a\u7ebf\u662f\u4f1a\u62a5\u9519\u7684\uff1a\n\n![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9825e41c39b940579a37f9fe61d708bd~tplv-k3u1fbpfcp-watermark.image)\n\n2. \u5982\u4f55\u6355\u83b7\u9519\u8bef,\u53ef\u4ee5\u53c2\u8003 MDN [testing_for_availability](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API#testing_for_availability)\n\n\u5927\u81f4\u662f\u5bf9Error\u7684\u9519\u8bef\u7801\u548cname\u8fdb\u884c\u5224\u65ad\n```js\n\ne instanceof DOMException && (\n            // everything except Firefox\n            e.code === 22 ||\n            // Firefox\n            e.code === 1014 ||\n            // test name field too, because code might not be present\n            // everything except Firefox\n            e.name === 'QuotaExceededError' ||\n            // Firefox\n            e.name === 'NS_ERROR_DOM_QUOTA_REACHED') &&\n            // acknowledge QuotaExceededError only if there's something already stored\n            (storage && storage.length !== 0);\n\n```\n\n**\u53c2\u8003\u5f15\u7528**    \n[calculating-usage-of-localstorage-space](https://stackoverflow.com/questions/3027142/calculating-usage-of-localstorage-space)   \n[what-is-the-max-size-of-localstorage-values](https://stackoverflow.com/questions/2989284/what-is-the-max-size-of-localstorage-values/25812530#25812530)     \n[Test of localStorage limits/quota](https://arty.name/localstorage.html)\n\n## \u5e26\u56fe\u5e26\u4e8b\u4ef6\u7684**\u684c\u9762\u901a\u77e5**\n\u7f51\u9875\u4e5f\u53ef\u4ee5\u4ee5\u684c\u9762\u5f39\u6846\u7684\u5f62\u5f0f\u8fdb\u884c\u901a\u77e5\uff0c\u5148\u770b\u4e2a\u6548\u679c\u56fe\uff1a    \n\u6709\u5934\u50cf\uff0c\u6709\u6807\u9898\uff0c\u6709\u6587\u672c\uff0c**\u70b9\u51fb\u6d88\u606f\u901a\u77e5\u8fd8\u80fd\u8ba9\u7a97\u4f53\u805a\u7126**\uff0c\u771f\u5e05\u3002\n\n![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cac0c6b24ecc4438b9b4d6db4f05fd23~tplv-k3u1fbpfcp-watermark.image)\n\n**\u4ee3\u7801**\n```js\nfunction doNotify(title, options = {}, events = {}) {\n    const notification = new Notification(title, options);\n    for (let event in events) {\n        notification[event] = events[event];\n    }\n}\n\nfunction notify(title, options = {}, events = {}) {\n    if (!(\"Notification\" in window)) {\n        return console.error(\"This browser does not support desktop notification\");\n    }\n    else if (Notification.permission === \"granted\") {\n        doNotify(title, options, events);\n    } else if (Notification.permission !== \"denied\") {\n        Notification.requestPermission().then(function (permission) {           \n            if (permission === \"granted\") {\n                doNotify(title, options, events);\n            }\n        });\n    }\n}\n```\n\n**\u793a\u4f8b**   \ntag\u8fd8\u53ef\u4ee5\u7528\u53bb\u91cd\u6d88\u606f\u3002\n```js\n     notify(\"\u4e2d\u5956\u63d0\u793a\", {\n            icon: \"https://sf1-ttcdn-tos.pstatp.com/img/user-avatar/f1a9f122e925aeef5e4534ff7f706729~300x300.image\",\n            body: \"\u606d\u559c\u4f60\uff0c\u6398\u91d1\u7b7e\u5230\u4e00\u7b49\u5956\",\n            tag: \"prize\"\n        }, {\n            onclick(ev) {\n                console.log(ev);\n                ev.target.close();\n                window.focus();\n            }\n        })\n```\n\n**\u53c2\u8003\u5f15\u7528**  \n[notification](https://developer.mozilla.org/zh-CN/docs/Web/API/notification)   \n[\u4f7f\u7528 Web Notifications](https://developer.mozilla.org/zh-CN/docs/Web/API/Notifications_API/Using_the_Notifications_API)   \n\n## \u539f\u751f30\u884c\u4ee3\u7801\u5b9e\u73b0\u89c6\u9891\u622a\u56fe\n\n\u57fa\u672c\u539f\u7406\u5c31\u662f\u628a\u89c6\u9891\u753b\u5230Canvas\u91cc\u9762\uff0c\u7136\u540e\u8c03\u7528`toDataURL`\u6216\u8005`toBlob`\uff0c\u518d\u5229\u7528a\u6807\u7b7e\u6a21\u62df\u70b9\u51fb\uff0cdownload\u5c5e\u6027\u6307\u5b9a\u540d\u5b57\u3002\n\n\u770b\u4e00\u4e0b\u6548\u679c\uff1a\n\n![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/52f0f434712042fe86f89a3cd69f4977~tplv-k3u1fbpfcp-watermark.image)\n**\u4ee3\u7801**\n```js\n     function captureVideo(videoEl) {\n            let canvasEl;\n            let dataUrl;\n            try {\n                const cps = window.getComputedStyle(videoEl);\n                const width = +cps.getPropertyValue(\"width\").replace(\"px\", \"\");\n                const height = +cps.getPropertyValue(\"height\").replace(\"px\", \"\");\n\n                canvasEl = document.createElement(\"canvas\");\n                canvasEl.style.cssText = `position:fixed;left:-9999px`;\n                canvasEl.height = height;\n                canvasEl.width = width;\n\n                document.body.appendChild(canvasEl);\n                \n                const ctx = canvasEl.getContext(\"2d\");\n                ctx.drawImage(videoEl, 0, 0, width, height);\n                // const image = canvas.toDataURL(\"image/png\");\n                dataUrl = canvasEl.toDataURL();\n\n                document.body.removeChild(canvasEl);\n                canvasEl = null;\n                return dataUrl;\n            } finally {\n                if (canvasEl) {\n                    document.body.removeChild(canvasEl);\n                }\n                if (dataUrl) {\n                    return dataUrl;\n                }\n            }\n        }\n\n```\n\n **\u793a\u4f8b**   \n \u6ce8\u610f\u6dfb\u52a0`crossorigin=\"anonymous\"`\uff0c\u4e0d\u7136\u8f6c\u4e3a\u56fe\u7247\u4f1a\u5931\u8d25\u3002\n```js\n\n  <video id=\"videoEL\" controls autoplay crossorigin=\"anonymous\"\n        src=\"https://api.dogecloud.com/player/get.mp4?vcode=5ac682e6f8231991&userId=17&ext=.mp4\" width=\"500\"></video>\n\nfunction download(url) {\n    const aEl = document.createElement(\"a\");\n    aEl.href = url;\n    aEl.download = \"\u89c6\u9891.png\";\n    aEl.click();\n}\n\n\nfunction doCaptureVideo() {\n    const url = captureVideo(videoEL);\n    download(url);\n}\n\ndoCaptureVideo()\n```\n\n##  \u57fa\u4e8e`URLSearchParams`\u6216`URL`\u83b7\u53d6queryString\u7684\u503c\n\u5e38\u7528\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6b63\u5219\u6216\u8005`split`\u65b9\u6cd5\uff0c\u5176\u5b9e\u4e0d\u7136\uff0c`URLSearchParams`\u548c`URL`\u90fd\u80fd\u5f88\u597d\u7684\u5b9e\u73b0\u529f\u80fd\u3002  \n\n**\u4ee3\u7801**\n```js\nconst urlSP = new URLSearchParams(location.search);\nfunction getQueryString(key){\n    return urlSP.get(key)\n}\n\nconst urlObj = new URL(location.href);\nfunction getQueryString(key){\n    return urlObj.searchParams.get(key)\n}\n\n```\n**\u793a\u4f8b**\n```js\n\u6d4b\u8bd5\u5730\u5740\uff1a /index.html?pid=10\n\nconst log = console.log;\ngetQueryString\n\nlog(\"pid\", getQueryString(\"pid\"));  // pid 10\nlog(\"cid\", getQueryString(\"cid\"));  // cid null\n\n```\n**\u53c2\u8003\u5f15\u7528**   \nMDN\u6587\u732e\uff1a[URLSearchParams-MDN](https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams)   \nCanIUse\u517c\u5bb9\u6027: [URLSearchParams: 95.63%](https://caniuse.com/?search=URLSearchParams)   \nPolyfill: [url-search-params-polyfill](https://github.com/jerrybendy/url-search-params-polyfill)\n\n\n## \u57fa\u4e8e`atob`\u548c`btoa`\u7684base64\u7f16\u7801\u548c\u89e3\u7801\n\u6d4f\u89c8\u5668\u5185\u7f6e\u4e86base64\u7f16\u7801\u548c\u89e3\u7801\u7684\u80fd\u529b\uff0c\u7b2c\u4e09\u65b9\u5e93\uff0c\u4e0d\u9700\u8981\u7684\u3002    \n\n**\u4ee3\u7801**\n```js\nfunction utf8_to_b64( str ) {\n  return window.btoa(unescape(encodeURIComponent( str )));\n}\n\nfunction b64_to_utf8( str ) {\n  return decodeURIComponent(escape(window.atob( str )));\n}\n```\n\n**\u793a\u4f8b**\n```js\nutf8_to_b64('\u2713 \u00e0 la mode'); // \"4pyTIMOgIGxhIG1vZGU=\"\nb64_to_utf8('4pyTIMOgIGxhIG1vZGU='); // \"\u2713 \u00e0 la mode\"\n```\n\n**\u53c2\u8003\u5f15\u7528**      \nMDN\u6587\u732e\uff1a[atob](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/atob), [btoa](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/btoa)   \nCanIUse\u517c\u5bb9\u6027: [btoa 99.68%](https://caniuse.com/?search=btoa)   \nPolyfill: [MDN Polyfill](https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope/btoa#polyfill \"Permalink to Polyfill\")  \n[Base64](https://developer.mozilla.org/en-US/docs/Glossary/Base64)\n\n\n\n\n## **\u975e\u6b63\u5219\u66ff\u6362**\u7684html\u4ee3\u7801encode\u548cdecode\n\u5e38\u89c4\u7684\u65b9\u5f0f\u662f\u4f7f\u7528\u6b63\u5219\u66ff\u6362\uff0c\u8fd9\u91cc\u662f\u53e6\u5916\u4e00\u79cd\u601d\u8def\u3002\n\n\n**\u4ee3\u7801**\n```js\nfunction htmlencode(s){\n    var div = document.createElement('div');\n    div.appendChild(document.createTextNode(s));\n    var result = div.innerHTML;\n    div = null;\n    return result;\n}\nfunction htmldecode(s){\n    var div = document.createElement('div');\n    div.innerHTML = s;\n    var result = div.innerText || div.textContent;\n    div = null;\n    return result;\n}\n```\n\n**\u793a\u4f8b**\n```\nhtmlencode(\"<div>3>5 & 666</div>\"); // &lt;div&gt;3&gt;5 &amp; 666&lt;/div&gt;\nhtmldecode(\"&lt;div&gt;3&gt;5 &amp; 666&lt;/div&gt;\") // <div>3>5 & 666</div>\n```\n \n## \u76f8\u5bf9\u5730\u5740\u8f6c\u6362\u4e3a\u7edd\u5bf9\u5730\u5740\n\n\u57fa\u4e8e\u5f53\u524d\u9875\u9762\u7684\u76f8\u5bf9\u5730\u5740\u8f6c\u6362\u4e3a\u7edd\u5bf9\u5730\u5740\u3002    \n\n**\u4ee3\u7801**\n```js\nfunction realativeToAbs(href) {\n    let aEl = document.createElement(\"a\");\n    aEl.href = href;    \n\n    const result = aEl.href;\n    aEl = null;\n    return result;\n}\n```\n\n**\u793a\u4f8b**\n```js\nconsole.log(\"realativeToAbs\", realativeToAbs(\"../a/b/b/index.html\"));\n// realativeToAbs http://127.0.0.1:5500/a/b/b/index.html\n```\n\n## \u57fa\u4e8e`URL`\u6216\u8005`Crypto.getRandomValues`\u751f\u6210UUID\n\u57fa\u4e8e[URL.createObjectURL](https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL)\u6216\u8005[Crypto.getRandomValues](https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues)\n\nURL.createObjectURL \u4ea7\u751f\u7684\u5730\u5740\u4e3a `blob:https://developer.mozilla.org/cb48b940-c625-400a-a393-176c3635020b`, \u5176\u540e\u90e8\u5206\u5c31\u662f\u4e00\u4e2aUUID\n\n**\u4ee3\u7801**   \n\u65b9\u5f0f\u4e00\uff1a \n```js\nfunction genUUID() {\n    const url = URL.createObjectURL(new Blob([]));\n    // const uuid = url.split(\"/\").pop();\n    const uuid = url.substring(url.lastIndexOf('/')+ 1);\n    URL.revokeObjectURL(url);\n    return uuid;\n}\n\ngenUUID() // cd205467-0120-47b0-9444-894736d873c7\n\n```\n\u65b9\u5f0f\u4e8c\uff1a  \n\n```js\nfunction uuidv4() {\n  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n}\n\nuuidv4() // 38aa1602-ba78-4368-9235-d8703cdb6037\n```\n\n\n**\u53c2\u8003\u5f15\u7528**   \n[generating-uuids-at-scale-on-the-web-2877f529d2a2](https://medium.com/teads-engineering/generating-uuids-at-scale-on-the-web-2877f529d2a2)      \n[collisions-when-generating-uuids-in-javascript](https://stackoverflow.com/questions/6906916/collisions-when-generating-uuids-in-javascript)\n\n\n## \u57fa\u4e8e`Array.from`\u7684\u5e8f\u5217\u751f\u6210\u5668\n\u9020\u6709\u5e8f\u6570\u636e\uff0c\u65e0\u5e8f\u6570\u636e\uff0c\u7b49\u7b49\u3002\n\n**\u4ee3\u7801**\n```js\nconst range = (start, stop, step) => Array.from(\n    { length: (stop - start) / step + 1}, \n    (_, i) => start + (i * step)\n);\n```\n\n**\u793a\u4f8b**\n```js\nrange(0, 4, 1); // [0, 1, 2, 3, 4]\nrange(0, 9, 3); // [0, 3, 6, 9]\nrange(0, 8, 2.5) // [0, 2.5, 5, 7.5]\n```\n\n##  \u57fa\u4e8e`sendBeacon`\u7684\u5b89\u5168\u7684\u6570\u636e\u4e0a\u62a5\n[sendBeacon](https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/sendBeacon) \u5f02\u6b65\u5730\u5411\u670d\u52a1\u5668\u53d1\u9001\u6570\u636e\uff0c\u540c\u65f6\u4e0d\u4f1a\u5ef6\u8fdf\u9875\u9762\u7684\u5378\u8f7d\u6216\u5f71\u54cd\u4e0b\u4e00\u5bfc\u822a\u7684\u8f7d\u5165\u6027\u80fd\u3002\n```js\nfunction report(url, data) {\n    if (typeof navigator.sendBeacon !== \"function\") {\n        return console.error(\"sendBeacon\u4e0d\u88ab\u652f\u6301\");\n    }\n    navigator.sendBeacon(url, data);\n}\n```\n\n**\u793a\u4f8b**  \n```js\nwindow.addEventListener('unload', logData, false);\nfunction logData() {\n   report(\"/log\", \"\u88ab\u5378\u8f7d\u4e86\");\n}\n```\n\n## \u57fa\u4e8e`toLocaleString`\u5343\u5206\u4f4d\n\u6b63\u5219\uff1f \u904d\u5386\uff1f \u4e0d\u9700\u8981\u7684\u3002\u5185\u7f6e\u51fd\u6570\u5c31\u89e3\u51b3\u3002      \n\u5f53\u7136\uff0c\u5982\u679c\u662f\u8d85\u5927\u7684\u6570\uff0c\u53ef\u80fd\u662f\u4f1a\u6709\u95ee\u9898\u7684\u3002\n\n**\u4ee3\u7801**\n```\nfunction formatMoney(num){\n    return (+num).toLocaleString(\"en-US\");\n}\n```\n**\u793a\u4f8b**\n\n```\nconsole.log(formatMoney(123456789));  // 123,456,789\nconsole.log(formatMoney(6781)) // 6,781\nconsole.log(formatMoney(5)) // 5\n\n\u8d85\u5927\u7684\u6570\nformatMoney(19999999933333333333333) // 19,999,999,933,333,333,000,000\n```\n\n## Promise\u987a\u5e8f\u6267\u884c\n\n\u8ba9Promise\u987a\u5e8f\u7684\u6267\u884c\uff0c\u5e76\u652f\u6301\u521d\u59cb\u5316\u53c2\u6570\u548c\u7ed3\u679c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u3002   \n\n**\u4ee3\u7801**\n```js\nfunction runPromises(promiseCreators, initData) {\n    return promiseCreators\n        .reduce((promise, next) => promise\n                .then((data) => next(data))\n            , Promise.resolve(initData));\n}\n```\n\n**\u793a\u4f8b**\n```js\nvar promise1 = function (data = 0) {\n    return new Promise(resolve => {\n        resolve(data + 1000);\n    });\n}\nvar promise2 = function (data) {\n    return new Promise(resolve => {\n        resolve(data -500);\n    });\n}\n\nrunPromises([promise1, promise2], 1).then(res=>console.log(res));\n```\n## \u5ef6\u65f6\u6267\u884cdelay\n\u5ef6\u65f6\u6267\u884c\u67d0\u51fd\u6570\uff0c\u4e14\u53ea\u4f1a\u6267\u884c\u4e00\u6b21\u3002\n\n**\u4ee3\u7801**\n```js\nfunction delay(fn = () => { }, delay = 5000, context = null) {\n    let ticket = null;\n    let runned = false;\n    return {\n        run(...args) {\n            return new Promise((resolve, reject) => {\n                if (runned === true) {\n                    return;\n                }\n                runned = true;\n                ticket = setTimeout(async () => {\n                    try {\n                        const res = await fn.apply(context, args);\n                        resolve(res);\n                    } catch (err) {\n                        reject(err)\n                    }\n                }, delay)\n            })\n        },\n        cancel: () => {\n            clearTimeout(ticket);\n        }\n    }\n}\n```\n\n**\u793a\u4f8b**\n```js\ndelay(function () {\n    console.log(\"\u4f60\u4eec\u597d\");\n}).run();\n\nconst { run, cancel } = delay(function (name) {\n    console.log(\"\u4f60\u597d\uff1a\", name);\n});\n\nrun(\"\u5409\u4ed6\");\nrun(\"\u5409\u4ed6\");\n\n// \u4f60\u4eec\u597d\n// \u4f60\u597d\uff1a \u5409\u4ed6\n\n\n```\n\n## \u8fdb\u5ea6\u503c\u6620\u5c04\n\u8fdb\u5ea6\u6620\u5c04\uff0c\u6bd4\u8f83\u53ea\u6709 10%\u7684\u8fdb\u5ea6\uff0c\u786e\u8981\u663e\u793a50%\u7684\u8fdb\u5ea6\u7684\u573a\u666f\u3002\n\n**\u4ee3\u7801**\n```typescript\nfunction adjustProgress(progress: number, mapping: { real: number; target: number }[] = []) {\n    if (progress < 0) {\n        return 0;\n    }\n    if (!mapping || mapping.length <= 0) {\n        return progress;\n    }\n    // \u7b2c\u4e00\u4e2a\n    const f = mapping[0];\n    if (progress <= f.real) {\n        return progress * (f.target / f.real);\n    }\n    // \u6700\u540e\u4e00\u4e2a\n    const l = mapping[mapping.length - 1];\n    if (progress >= l.target) {\n        return l.target;\n    }\n    const curIndex = mapping.findIndex(m => m.real >= progress);\n    if (!curIndex) {\n        return progress;\n    }\n    const cur = mapping[curIndex];\n    const pre = mapping[curIndex - 1];\n    //     \u539f\u57fa\u6570     +   \u5b9e\u9645\u8fdb\u5ea6/\u6700\u5927\u5b9e\u9645\u8fdb\u5ea6 * \u671f\u671b\u95f4\u8ddd\n    return pre.target + (progress - pre.real) / (cur.real - pre.real) * (cur.target - pre.target);\n}\n\n```\n\n**\u793a\u4f8b**\n```js\nconst mapping = [{\n    real: 0,\n    target: 0,\n}, {\n    real: 30,\n    target: 50\n}, {\n    real: 60,\n    target: 80\n}, {\n    real: 100,\n    target: 100\n}];\n\n\nconsole.log(\"15\", adjustProgress(15, mapping));  // 15 25\nconsole.log(\"25\", adjustProgress(25, mapping)); // 25 41.66666666666667\nconsole.log(\"50\", adjustProgress(50, mapping)); // 50 70\nconsole.log(\"60\", adjustProgress(60, mapping)); // 60 80\nconsole.log(\"100\", adjustProgress(100, mapping)); // 100 100\n```\n\n\n## \u6ed1\u6eda\u52a8\u9875\u9762\u5230\u9876\u90e8\n\n**\u4ee3\u7801**\n\nPC\u7aef\u6eda\u52a8\u7684\u6839\u5143\u7d20\u662f`document.documentElement`,    \n\u79fb\u52a8\u7aef\u6eda\u52a8\u7684\u7684\u6839\u5143\u7d20\u662f`document.body`,    \n\u6709\u4e00\u4e2a\u66f4\u597d\u7684\u5c5e\u6027`document.scrollingElement`\u80fd\u81ea\u5df1\u8bc6\u522b\u6587\u6863\u7684\u6eda\u52a8\u5143\u7d20\uff0c \u5176\u5728PC\u7aef\u7b49\u4e8e`document.documentElement`, \u5176\u5728\u79fb\u52a8\u7aef\u7b49\u4e8e`document.body`\n\n```\n// smooth \u9009\u9879\u5728Safari\u4e0a\u652f\u6301\u4e0d\u597d\nfunction scrollToTop(){\n    window.scrollTo({\n        left: 0,\n        top: 0,\n        behavior: 'smooth\n    })\n}\n\nfunction scrollToTop() {\n    let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n    if (scrollTop > 0) {\n        window.requestAnimationFrame(scrollToTop);\n        window.scrollTo(0, scrollTop - scrollTop / 8);\n    }\n};\n\n```\n\n## \u7981\u6b62\u9009\u62e9\u548c\u590d\u5236\n\n**\u4ee3\u7801**\n```js\n['contextmenu', 'selectstart', 'copy'].forEach(function(ev){\n    document.addEventListener(ev, function(ev){\n        ev.preventDefault();\n        ev.returnValue = false;\n    })\n});\n```\n\u5f53\u7136\u4e5f\u6709CSS\u65b9\u6848  \n\n```css\nbody {\n    -moz-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    -khtml-user-select: none;\n    user-select: none;\n}\n```\n\n\n## \u7981\u6b62\u56fe\u7247\u62d6\u62fd\n**\u4ee3\u7801**  \n```js\n['dragstart'].forEach(function(ev){\n    document.addEventListener(ev, function(ev){\n        ev.preventDefault();\n        ev.returnValue = false;\n    })\n});\n\n```\n\n\n\n\n## \u81ea\u589e\u957fID\n\n\u81ea\u5df1\u751f\u4ea7\u81ea\u589e\u957f\u7684ID\u503c\uff0c\u5f53\u7136\u53ef\u4ee5\u66f4\u590d\u6742\u4e00\u4e9b\u3002\n\n**\u4ee3\u7801**\n```\nlet id = 0;\nfunction getId() {\n    return id++;\n}\n```\n\n\n**\u793a\u4f8b**\n```\nconsole.log(getId()); // 1\nconsole.log(getId()); // 2\n```\n\n\n\n## \u5199\u5728\u540e\u9762\n\u5199\u4f5c\u4e0d\u6613\uff0c\u4f60\u7684\u4e00\u8d5e\u4e00\u8bc4\uff0c\u5c31\u662f\u6211\u524d\u884c\u7684\u6700\u5927\u52a8\u529b\u3002\n\n"}, "author_user_info": {"user_id": "131597122679661", "user_name": "\u4e91\u7684\u4e16\u754c", "company": "\u4e91\u7684\u4e16\u754c", "job_title": "\u524d\u7aef\u5de5\u7a0b\u5e08", "avatar_large": "https://sf1-ttcdn-tos.pstatp.com/img/user-avatar/f1a9f122e925aeef5e4534ff7f706729~300x300.image", "level": 3, "description": "\u770b\u4e16\u754c\uff0c\u542c\u4e16\u754c\uff0c\u95ee\u4e16\u754c\u3002", "followee_count": 45, "follower_count": 448, "post_article_count": 28, "digg_article_count": 1155, "got_digg_count": 3527, "got_view_count": 122469, "post_shortmsg_count": 6, "digg_shortmsg_count": 1, "isfollowed": false, "favorable_author": 0, "power": 4751, "study_point": 0, "university": {"university_id": "0", "name": "", "logo": ""}, "major": {"major_id": "0", "parent_id": "0", "name": ""}, "student_status": 0, "select_event_count": 0, "select_online_course_count": 0, "identity": 0, "is_select_annual": false, "select_annual_rank": 0, "annual_list_type": 0, "extraMap": {}, "is_logout": 0}, "category": {"category_id": "6809637767543259144", "category_name": "\u524d\u7aef", "category_url": "frontend", "rank": 2, "ctime": 1457483942, "mtime": 1432503190, "show_type": 3, "item_type": 2}, "tags": [{"id": 2546526, "tag_id": "6809640407484334093", "tag_name": "\u524d\u7aef", "color": "#60ADFF", "icon": "https://lc-gold-cdn.xitu.io/bac28828a49181c34110.png", "back_ground": "", "show_navi": 1, "ctime": 1435971546, "mtime": 1627872151, "id_type": 9, "tag_alias": "", "post_article_count": 74593, "concern_user_count": 526758}, {"id": 2546519, "tag_id": "6809640398105870343", "tag_name": "JavaScript", "color": "#616161", "icon": "https://lc-gold-cdn.xitu.io/5d70fd6af940df373834.png", "back_ground": "", "show_navi": 0, "ctime": 1435884803, "mtime": 1627872268, "id_type": 9, "tag_alias": "", "post_article_count": 62689, "concern_user_count": 398161}], "user_interact": {"id": 6987166546502090788, "omitempty": 2, "user_id": 0, "is_digg": false, "is_follow": false, "is_collect": false}, "org": {"org_info": null, "org_user": null, "is_followed": false}, "req_id": "server req_id test"}